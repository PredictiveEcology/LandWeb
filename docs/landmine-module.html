<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 LandMine Module | LandWeb Manual</title>
<meta name="author" content="Alex M. Chubaty; Ceres Barros; Ian M. S. Eddy; Eliot J. B. McIntire; David W. Andison">
<meta name="description" content="This documentation is work in progress. Please report any discrepancies or omissions at https://github.com/PredictiveEcology/LandMine/issues.  8.0.0.1 Authors: Eliot J B McIntire...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 8 LandMine Module | LandWeb Manual">
<meta property="og:type" content="book">
<meta property="og:url" content="https://predictiveecology.github.io/LandWeb/landmine-module.html">
<meta property="og:description" content="This documentation is work in progress. Please report any discrepancies or omissions at https://github.com/PredictiveEcology/LandMine/issues.  8.0.0.1 Authors: Eliot J B McIntire...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 LandMine Module | LandWeb Manual">
<meta name="twitter:description" content="This documentation is work in progress. Please report any discrepancies or omissions at https://github.com/PredictiveEcology/LandMine/issues.  8.0.0.1 Authors: Eliot J B McIntire...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="v. 3.0.0">LandWeb Manual</a>:
        <small class="text-muted">v. 3.0.0</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="getting-started.html"><span class="header-section-number">1</span> Getting started</a></li>
<li><a class="" href="running-landweb.html"><span class="header-section-number">2</span> Running LandWeb</a></li>
<li><a class="" href="study-areas.html">Study areas</a></li>
<li><a class="" href="landr-landweb_preamble-module.html"><span class="header-section-number">3</span> LandR LandWeb_preamble Module</a></li>
<li><a class="" href="vegetation-submodel.html">Vegetation submodel</a></li>
<li><a class="" href="landr-biomass_speciesdata-module.html"><span class="header-section-number">4</span> LandR Biomass_speciesData Module</a></li>
<li><a class="" href="landr-biomass_borealdataprep-module.html"><span class="header-section-number">5</span> LandR Biomass_borealDataPrep Module</a></li>
<li><a class="" href="landr-biomass_core-module.html"><span class="header-section-number">6</span> LandR Biomass_core Module</a></li>
<li><a class="" href="landr-biomass_regeneration-module.html"><span class="header-section-number">7</span> LandR Biomass_regeneration Module</a></li>
<li><a class="" href="wildfire-submodel.html">Wildfire submodel</a></li>
<li><a class="active" href="landmine-module.html"><span class="header-section-number">8</span> LandMine Module</a></li>
<li><a class="" href="model-outputs.html">Model outputs</a></li>
<li><a class="" href="web-app.html">Web app</a></li>
<li><a class="" href="modifying-landweb.html"><span class="header-section-number">9</span> Modifying LandWeb</a></li>
<li><a class="" href="references-1.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PredictiveEcology/LandWeb">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="landmine-module" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> <em>LandMine</em> Module<a class="anchor" aria-label="anchor" href="#landmine-module"><i class="fas fa-link"></i></a>
</h1>
<!-- the following are text references used in captions for LaTeX compatibility -->

<div class="rmdwarning">
<p>This documentation is work in progress.
Please report any discrepancies or omissions at <a href="https://github.com/PredictiveEcology/LandMine/issues" class="uri">https://github.com/PredictiveEcology/LandMine/issues</a>.</p>
</div>
<div id="authors-5" class="section level4" number="8.0.0.1">
<h4>
<span class="header-section-number">8.0.0.1</span> Authors:<a class="anchor" aria-label="anchor" href="#authors-5"><i class="fas fa-link"></i></a>
</h4>
<p>Eliot J B McIntire <a href="mailto:eliot.mcintire@nrcan-rncan.gc.ca" class="email">eliot.mcintire@nrcan-rncan.gc.ca</a> [aut, cre], Alex M. Chubaty <a href="mailto:achubaty@for-cast.ca" class="email">achubaty@for-cast.ca</a> [ctb]
<!-- ideally separate authors with new lines, '\n' not working --></p>
</div>
<div id="module-overview-5" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Module Overview<a class="anchor" aria-label="anchor" href="#module-overview-5"><i class="fas fa-link"></i></a>
</h2>
<div id="module-summary-3" class="section level3" number="8.1.1">
<h3>
<span class="header-section-number">8.1.1</span> Module summary<a class="anchor" aria-label="anchor" href="#module-summary-3"><i class="fas fa-link"></i></a>
</h3>
<p>Landmine is a model created for simulating the natural range of variation for landscapes in the boreal forest <span class="citation">(<a href="references-1.html#ref-Andison:1996">Andison 1996</a>; <a href="references-1.html#ref-Andison:1998">Andison 1998</a>)</span>.
It has been widely used by the public and the private sector for various purposes.
This SpaDES module is a rewrite of the fire component in native R.</p>
</div>
<div id="model-differences" class="section level3" number="8.1.2">
<h3>
<span class="header-section-number">8.1.2</span> Model Differences<a class="anchor" aria-label="anchor" href="#model-differences"><i class="fas fa-link"></i></a>
</h3>
<p>The current version has not yet been fully tested and compared with the original version, but there are currently several known differences:</p>
<ol style="list-style-type: decimal">
<li>Fire sizes are taken from a Truncated Pareto distribution, resulting in numerous very small fires, and few large fires;</li>
<li>Parameters have been fitted to the landscapes that are under study in the LandWeb project.</li>
</ol>
</div>
<div id="known-species" class="section level3" number="8.1.3">
<h3>
<span class="header-section-number">8.1.3</span> Known Species<a class="anchor" aria-label="anchor" href="#known-species"><i class="fas fa-link"></i></a>
</h3>
<p>Landmine requires the following codes as inputs (the genus and species codes below), which converts and groups species as follows.
Each of the species groups has its own Rate of Spread (ROS) for fire spreading:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:species-table">Table 8.1: </span>LandMine species codes.</caption>
<thead><tr class="header">
<th align="left">Species</th>
<th align="left">Group</th>
<th align="left">Code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Jack pine</td>
<td align="left">Pine (PINU)</td>
<td align="left">Pinu_ban</td>
</tr>
<tr class="even">
<td align="left">Lodgepole pine</td>
<td align="left">Pine (PINU)</td>
<td align="left">Pinu_con</td>
</tr>
<tr class="odd">
<td align="left">Unspecified pine species</td>
<td align="left">Pine (PINU)</td>
<td align="left">Pinu_sp</td>
</tr>
<tr class="even">
<td align="left">Paper birch</td>
<td align="left">Deciduous (DECI)</td>
<td align="left">Betu_pap</td>
</tr>
<tr class="odd">
<td align="left">Balsam poplar</td>
<td align="left">Deciduous (DECI)</td>
<td align="left">Popu_bal</td>
</tr>
<tr class="even">
<td align="left">Trembling aspen</td>
<td align="left">Deciduous (DECI)</td>
<td align="left">Popu_tre</td>
</tr>
<tr class="odd">
<td align="left">Larch/Tamarack</td>
<td align="left">Deciduous (DECI)</td>
<td align="left">Lari_lar</td>
</tr>
<tr class="even">
<td align="left">Black spruce</td>
<td align="left">Black spruce (PICE_MAR)</td>
<td align="left">Pice_mar</td>
</tr>
<tr class="odd">
<td align="left">White spruce</td>
<td align="left">White spruce (PICE_GLA)</td>
<td align="left">Pice_gla</td>
</tr>
<tr class="even">
<td align="left">Fir species</td>
<td align="left">Fir (ABIE)</td>
<td align="left">Abie_sp</td>
</tr>
</tbody>
</table></div>
<div style="page-break-after: always;"></div>
</div>
<div id="module-inputs-and-parameters-1" class="section level3" number="8.1.4">
<h3>
<span class="header-section-number">8.1.4</span> Module inputs and parameters<a class="anchor" aria-label="anchor" href="#module-inputs-and-parameters-1"><i class="fas fa-link"></i></a>
</h3>
<p>Table <a href="landmine-module.html#tab:moduleInputs-LandMine">8.2</a> shows the full list of module inputs.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:moduleInputs-LandMine">Table 8.2: </span>List of <em>LandMine</em> input objects and their description.</caption>
<colgroup>
<col width="4%">
<col width="6%">
<col width="86%">
<col width="2%">
</colgroup>
<thead><tr class="header">
<th align="left">objectName</th>
<th align="left">objectClass</th>
<th align="left">desc</th>
<th align="left">sourceURL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">cohortData</td>
<td align="left">data.table</td>
<td align="left">Columns: B, pixelGroup, speciesCode (as a factor of the names), age. indicating several features about the current vegetation of stand.</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">fireReturnInterval</td>
<td align="left">Raster</td>
<td align="left">A raster layer that is a factor raster, with at least 1 column called ‘fireReturnInterval’, representing the fire return interval in years.</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">pixelGroupMap</td>
<td align="left">RasterLayer</td>
<td align="left">Pixels with identical values share identical stand features</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">rasterToMatch</td>
<td align="left">RasterLayer</td>
<td align="left">DESCRIPTION NEEDED</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">ROSTable</td>
<td align="left">data.table</td>
<td align="left">A data.table with 3 columns, ‘age’, ‘leading’, and ‘ros’. The values under the ‘age’ column can be ‘mature’, ‘immature’, ‘young’ and compound versions of these, e.g., ‘immature_young’ which can be used when 2 or more age classes share same ‘ros’. ‘leading’ should be vegetation type. ‘ros’ gives the rate of spread values for each age and type.</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">rstFlammable</td>
<td align="left">Raster</td>
<td align="left">A raster layer, with 0, 1 and NA, where 1 indicates areas that are flammable, 0 not flammable (e.g., lakes) and NA not applicable (e.g., masked)</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">rstTimeSinceFire</td>
<td align="left">Raster</td>
<td align="left">a time since fire raster layer</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">species</td>
<td align="left">data.table</td>
<td align="left">Columns: species, speciesCode, Indicating several features about species</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">sppColorVect</td>
<td align="left">character</td>
<td align="left">named character vector of hex colour codes corresponding to each species</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">sppEquiv</td>
<td align="left">data.table</td>
<td align="left">Multi-columned data.table indicating species name equivalencies. Default taken from LandR sppEquivalencies_CA which has names for species of trees in Canada</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">studyArea</td>
<td align="left">SpatialPolygonsDataFrame</td>
<td align="left">multipolygon, typically buffered around an area of interest (i.e., <code>studyAreaReporting</code>) to use for simulation. Defaults to an area in Southwestern Alberta, Canada.</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">studyAreaReporting</td>
<td align="left">SpatialPolygonsDataFrame</td>
<td align="left">multipolygon (typically smaller/unbuffered than <code>studyArea</code>) to use for plotting/reporting. Defaults to an area in Southwestern Alberta, Canada.</td>
<td align="left">NA</td>
</tr>
</tbody>
</table></div>
<p>Summary of user-visible parameters (Table <a href="landmine-module.html#tab:moduleParams-LandMine">8.3</a>).</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:moduleParams-LandMine">Table 8.3: </span>List of <em>LandMine</em> parameters and their description.</caption>
<colgroup>
<col width="7%">
<col width="3%">
<col width="2%">
<col width="1%">
<col width="1%">
<col width="83%">
</colgroup>
<thead><tr class="header">
<th align="left">paramName</th>
<th align="left">paramClass</th>
<th align="left">default</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">paramDesc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">biggestPossibleFireSizeHa</td>
<td align="left">numeric</td>
<td align="left">1e+06</td>
<td align="left">10000</td>
<td align="left">2e+06</td>
<td align="left">An upper limit, in hectares, of the truncated Pareto distribution of fire sizes</td>
</tr>
<tr class="even">
<td align="left">burnInitialTime</td>
<td align="left">numeric</td>
<td align="left">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">This describes the simulation time at which the first burn event should occur</td>
</tr>
<tr class="odd">
<td align="left">fireTimestep</td>
<td align="left">numeric</td>
<td align="left">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">This describes the simulation time interval between burn events</td>
</tr>
<tr class="even">
<td align="left">flushCachedRandomFRI</td>
<td align="left">logical</td>
<td align="left">FALSE</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">If no Fire Return Interval map is supplied, then a random one will be created and cached. Use this to make a new one.</td>
</tr>
<tr class="odd">
<td align="left">minPropBurn</td>
<td align="left">numeric</td>
<td align="left">0.9</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">Minimum proportion burned pixels to use when triggering warnings about simulated fires.</td>
</tr>
<tr class="even">
<td align="left">mixedType</td>
<td align="left">numeric</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">How to define mixed stands: 1 for any species admixture; 2 for deciduous &gt; conifer. See ?vegTypeMapGenerator.</td>
</tr>
<tr class="odd">
<td align="left">maxRetriesPerID</td>
<td align="left">integer</td>
<td align="left">4</td>
<td align="left">0</td>
<td align="left">20</td>
<td align="left">Number of attempts (‘jumps’) that will be made per event ID, before abandoning. See <code><a href="https://spades-tools.predictiveecology.org/reference/spread2.html">?SpaDES.tools::spread2</a></code>. NOTE: increasing this value results in drastically longer simulation times because firelets get ‘stuck’.</td>
</tr>
<tr class="even">
<td align="left">maxReburns</td>
<td align="left">integer</td>
<td align="left">10</td>
<td align="left">0</td>
<td align="left">20</td>
<td align="left">Number of attempts to reburn fires that don’t reach their target fire size. Unlike <code>maxRetriesPerID</code>, which tries spreading an ongoing fire to nearby cells, this reignites the fire from a new pixel, so it’s less likely to continue being stuck in a region with sinuous fires.</td>
</tr>
<tr class="odd">
<td align="left">ROSother</td>
<td align="left">integer</td>
<td align="left">30</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">default ROS value for non-forest vegetation classes.this is needed when passing a modified <code>ROSTable</code>, e.g. using log-transformed values.</td>
</tr>
<tr class="even">
<td align="left">ROStype</td>
<td align="left">character</td>
<td align="left">default</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">One of ‘burny’, ‘equal’, ‘log’, or ‘default’.</td>
</tr>
<tr class="odd">
<td align="left">sppEquivCol</td>
<td align="left">character</td>
<td align="left">LandR</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">The column in <code>sim$specieEquivalency</code> data.table to use as a naming convention.</td>
</tr>
<tr class="even">
<td align="left">useSeed</td>
<td align="left">integer</td>
<td align="left"></td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">Only used for creating a starting cohortData dataset. If <code>NULL</code>, then it will be randomly generated; If non-<code>NULL</code>, will pass this value to set.seed and be deterministic and identical each time. WARNING: setting the seed to a specific value will cause all simulations to be identical!</td>
</tr>
<tr class="odd">
<td align="left">vegLeadingProportion</td>
<td align="left">numeric</td>
<td align="left">0.8</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">a number that define whether a species is leading for a given pixel</td>
</tr>
<tr class="even">
<td align="left">.plotInitialTime</td>
<td align="left">numeric</td>
<td align="left">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">This describes the simulation time at which the first plot event should occur</td>
</tr>
<tr class="odd">
<td align="left">.plotInterval</td>
<td align="left">numeric</td>
<td align="left">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">This describes the simulation time interval between plot events</td>
</tr>
<tr class="even">
<td align="left">.plots</td>
<td align="left">character</td>
<td align="left">object</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">Passed to <code>types</code> in <code>Plots</code> (see <code>?Plots</code>). There are a few plots that are made within this module, if set. Note that plots (or their data) saving will ONLY occur at <code>end(sim)</code>. If <code>NA</code>, plotting is turned off completely (this includes plot saving).</td>
</tr>
<tr class="odd">
<td align="left">.saveInitialTime</td>
<td align="left">numeric</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">This describes the simulation time at which the first save event should occur</td>
</tr>
<tr class="even">
<td align="left">.saveInterval</td>
<td align="left">numeric</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">This describes the simulation time interval between save events</td>
</tr>
<tr class="odd">
<td align="left">.useCache</td>
<td align="left">logical</td>
<td align="left">FALSE</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">Should this entire module be run with caching activated? This is generally intended for data-type modules, where stochasticity and time are not relevant</td>
</tr>
<tr class="even">
<td align="left">.unitTest</td>
<td align="left">logical</td>
<td align="left">TRUE</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">Some functions can have internal testing. This will turn those on or off, if any exist.</td>
</tr>
<tr class="odd">
<td align="left">.useParallel</td>
<td align="left">numeric</td>
<td align="left">2</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">Used in burning. Will be passed to <code><a href="https://Rdatatable.gitlab.io/data.table/reference/openmp-utils.html">data.table::setDTthreads()</a></code>. NOTE: use <code>.useParallel &lt;= 2</code> as the additonal RAM overhead too high given marginal speedup.</td>
</tr>
</tbody>
</table></div>
</div>
<div id="module-outputs-2" class="section level3" number="8.1.5">
<h3>
<span class="header-section-number">8.1.5</span> Module outputs<a class="anchor" aria-label="anchor" href="#module-outputs-2"><i class="fas fa-link"></i></a>
</h3>
<p>Description of the module outputs (Table <a href="landmine-module.html#tab:moduleOutputs-LandMine">8.4</a>).</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:moduleOutputs-LandMine">Table 8.4: </span>List of <em>LandMine</em> outputs and their description.</caption>
<colgroup>
<col width="12%">
<col width="4%">
<col width="83%">
</colgroup>
<thead><tr class="header">
<th align="left">objectName</th>
<th align="left">objectClass</th>
<th align="left">desc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">fireInitialTime</td>
<td align="left">numeric</td>
<td align="left">The initial event time of the burn event. This is simply a reassignment from P(sim)<span class="math inline">\(burnInitialTime. | |fireSizes |list |A list of data.tables, one per burn event, each with two columns, size and maxSize. These indicate the actual sizes and expected sizes burned, respectively. These can be put into a single data.table with rbindlist(sim\)</span>fireSizes, idcol = ‘year’)</td>
</tr>
<tr class="even">
<td align="left">fireReturnInterval</td>
<td align="left">RasterLayer</td>
<td align="left">A Raster map showing the fire return interval. This is created from the rstCurrentBurn.</td>
</tr>
<tr class="odd">
<td align="left">fireReturnIntervalsByPolygonNumeric</td>
<td align="left">numeric</td>
<td align="left">A vector of the fire return intervals, ordered by the numeric representation of polygon ID</td>
</tr>
<tr class="even">
<td align="left">fireTimestep</td>
<td align="left">numeric</td>
<td align="left">The number of time units between successive fire events in a fire module.</td>
</tr>
<tr class="odd">
<td align="left">kBest</td>
<td align="left">numeric</td>
<td align="left">A numeric scalar that is the optimal value of K in the Truncated Pareto distribution (rtruncpareto)</td>
</tr>
<tr class="even">
<td align="left">numFiresPerYear</td>
<td align="left">numeric</td>
<td align="left">The average number of fires per year, by fire return interval level on rstCurrentBurn.</td>
</tr>
<tr class="odd">
<td align="left">rstCurrentBurn</td>
<td align="left">RasterLayer</td>
<td align="left">A raster layer, produced at each timestep, where each pixel is either 1 or 0 indicating burned or not burned.</td>
</tr>
<tr class="even">
<td align="left">rstCurrentBurnCumulative</td>
<td align="left">RasterLayer</td>
<td align="left">Cumulative number of times a pixel has burned</td>
</tr>
<tr class="odd">
<td align="left">sppEquiv</td>
<td align="left">data.table</td>
<td align="left">Same as input, but with new column, LandMine</td>
</tr>
</tbody>
</table></div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="usage" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Usage<a class="anchor" aria-label="anchor" href="#usage"><i class="fas fa-link"></i></a>
</h2>
<p>To run this Landmine module alone (<em>i.e.</em>, for fitting), the following should work (<em>iff</em> raster inputs for <code>rstStudyRegion</code> and <code>rstFlammable</code> are available), assuming all R packages are available.</p>
<p><strong>NB:</strong> Paths will have be changed for a different user.</p>
<div id="package-dependencies" class="section level3" number="8.2.1">
<h3>
<span class="header-section-number">8.2.1</span> Package dependencies<a class="anchor" aria-label="anchor" href="#package-dependencies"><i class="fas fa-link"></i></a>
</h3>
<p>To determine which packages are used by <code>LandMine</code>, use:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">SpaDES.core</span><span class="fu">::</span><span class="fu"><a href="https://spades-core.predictiveecology.org/reference/packages.html">packages</a></span><span class="op">(</span>modules <span class="op">=</span> <span class="st">"LandMine"</span>, paths <span class="op">=</span> <span class="va">moduleDir</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code>##  [1] "SpaDES.core"                                        
##  [2] "assertthat"                                         
##  [3] "data.table"                                         
##  [4] "ggplot2"                                            
##  [5] "grDevices"                                          
##  [6] "magrittr"                                           
##  [7] "PredictiveEcology/LandR@development (&gt;= 1.1.0.9003)"
##  [8] "PredictiveEcology/pemisc@development"               
##  [9] "PredictiveEcology/SpaDES.tools@development"         
## [10] "raster"                                             
## [11] "RColorBrewer"                                       
## [12] "VGAM"</code></pre>
</div>
<div id="module-usage" class="section level3" number="8.2.2">
<h3>
<span class="header-section-number">8.2.2</span> Module usage<a class="anchor" aria-label="anchor" href="#module-usage"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">studyArea</span> <span class="op">&lt;-</span> <span class="fu">SpaDES.tools</span><span class="fu">::</span><span class="fu"><a href="https://spades-tools.predictiveecology.org/reference/randomStudyArea.html">randomStudyArea</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">1234</span>, size <span class="op">=</span> <span class="fl">1e+10</span><span class="op">)</span></span>
<span><span class="va">rasterToMatch</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="va">studyArea</span>, res <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="landmine-module.html#cb39-1" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">start =</span> <span class="dv">0</span>, <span class="at">end =</span> <span class="dv">13</span>)</span>
<span id="cb39-2"><a href="landmine-module.html#cb39-2" tabindex="-1"></a></span>
<span id="cb39-3"><a href="landmine-module.html#cb39-3" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="co"># LandMine = list(flushCachedRandomFRI = TRUE) ) parameters</span></span>
<span id="cb39-4"><a href="landmine-module.html#cb39-4" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="co"># LandMine = list(flushCachedRandomFRI = TRUE) ) &lt;-</span></span>
<span id="cb39-5"><a href="landmine-module.html#cb39-5" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="co"># LandMine = list(flushCachedRandomFRI = TRUE) ) list(#</span></span>
<span id="cb39-6"><a href="landmine-module.html#cb39-6" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="co"># LandMine = list(flushCachedRandomFRI = TRUE) ) LandMine</span></span>
<span id="cb39-7"><a href="landmine-module.html#cb39-7" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="co"># LandMine = list(flushCachedRandomFRI = TRUE) ) =</span></span>
<span id="cb39-8"><a href="landmine-module.html#cb39-8" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="co"># LandMine = list(flushCachedRandomFRI = TRUE) ) list(flushCachedRandomFRI</span></span>
<span id="cb39-9"><a href="landmine-module.html#cb39-9" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="co"># LandMine = list(flushCachedRandomFRI = TRUE) ) =</span></span>
<span id="cb39-10"><a href="landmine-module.html#cb39-10" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="co"># LandMine = list(flushCachedRandomFRI = TRUE) ) TRUE)</span></span>
<span id="cb39-11"><a href="landmine-module.html#cb39-11" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="co"># LandMine = list(flushCachedRandomFRI = TRUE) ) )</span></span>
<span id="cb39-12"><a href="landmine-module.html#cb39-12" tabindex="-1"></a></span>
<span id="cb39-13"><a href="landmine-module.html#cb39-13" tabindex="-1"></a>modules <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"LandMine"</span>)</span>
<span id="cb39-14"><a href="landmine-module.html#cb39-14" tabindex="-1"></a></span>
<span id="cb39-15"><a href="landmine-module.html#cb39-15" tabindex="-1"></a>objects <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">studyArea =</span> studyArea, <span class="at">rasterToMatch =</span> rasterToMatch)</span>
<span id="cb39-16"><a href="landmine-module.html#cb39-16" tabindex="-1"></a></span>
<span id="cb39-17"><a href="landmine-module.html#cb39-17" tabindex="-1"></a>paths <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">cachePath =</span> cacheDir, <span class="at">modulePath =</span> moduleDir, <span class="at">inputPath =</span> inputDir,</span>
<span id="cb39-18"><a href="landmine-module.html#cb39-18" tabindex="-1"></a>    <span class="at">outputPath =</span> outputDir)</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mySim</span> <span class="op">&lt;-</span> <span class="fu">simInit</span><span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>, params <span class="op">=</span> <span class="va">parameters</span>, modules <span class="op">=</span> <span class="va">modules</span>,</span>
<span>    objects <span class="op">=</span> <span class="va">objects</span>, paths <span class="op">=</span> <span class="va">paths</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dev</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mySimOut</span> <span class="op">&lt;-</span> <span class="fu">spades</span><span class="op">(</span><span class="va">mySim</span>, .plotInitialTime <span class="op">=</span> <span class="va">times</span><span class="op">$</span><span class="va">start</span>, debug <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="testing-the-burn-algorithm" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Testing the burn algorithm<a class="anchor" aria-label="anchor" href="#testing-the-burn-algorithm"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://Require.predictiveecology.org/reference/Require.html">Require</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"data.table"</span>, <span class="st">"DEoptim"</span>, <span class="st">"parallel"</span>, <span class="st">"SDMTools"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">simInit</span><span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>, params <span class="op">=</span> <span class="va">parameters</span>, modules <span class="op">=</span> <span class="va">modules</span>,</span>
<span>    objects <span class="op">=</span> <span class="va">objects</span>, paths <span class="op">=</span> <span class="va">paths</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ros</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="fu">extent</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250000</span>, <span class="fl">0</span>, <span class="fl">250000</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">250</span>, vals <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ros</span> <span class="op">&lt;-</span> <span class="va">ros</span> <span class="op">==</span> <span class="fl">0</span></span>
<span><span class="va">fireSize</span> <span class="op">&lt;-</span> <span class="fl">1e+05</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">moduleDir</span>, <span class="st">"LandMine"</span>, <span class="st">"R"</span>, <span class="st">"burn.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">burnFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ros</span>, <span class="va">centreCell</span>, <span class="va">fireSize</span>, <span class="va">spawnNewActive</span>,</span>
<span>    <span class="va">sizeCutoffs</span>, <span class="va">burn1</span>, <span class="va">spreadProb</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">burned</span> <span class="op">&lt;-</span> <span class="fu">burn1</span><span class="op">(</span>landscape <span class="op">=</span> <span class="va">ros</span>, startCells <span class="op">=</span> <span class="va">centreCell</span>,</span>
<span>        fireSizes <span class="op">=</span> <span class="va">fireSize</span>, spreadProb <span class="op">=</span> <span class="va">spreadProb</span>, spreadProbRel <span class="op">=</span> <span class="va">ros</span>,</span>
<span>        spawnNewActive <span class="op">=</span> <span class="va">spawnNewActive</span>, sizeCutoffs <span class="op">=</span> <span class="va">sizeCutoffs</span><span class="op">)</span></span>
<span>    <span class="va">burnedMap</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="va">ros</span><span class="op">)</span></span>
<span>    <span class="va">burnedMap</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span>    <span class="va">burnedMap</span><span class="op">[</span><span class="va">burned</span><span class="op">$</span><span class="va">pixels</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">burned</span><span class="op">$</span><span class="va">initialPixels</span></span>
<span>    <span class="va">LM</span> <span class="op">&lt;-</span> <span class="fu">SDMTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SDMTools/man/PatchStat.html">PatchStat</a></span><span class="op">(</span><span class="va">burnedMap</span>, cellsize <span class="op">=</span> <span class="fu">res</span><span class="op">(</span><span class="va">burnedMap</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>burnedMap <span class="op">=</span> <span class="va">burnedMap</span>, LM <span class="op">=</span> <span class="va">LM</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">makeParallel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">wantParallel</span>, <span class="va">numClus</span>, <span class="va">cl</span>, <span class="va">funs</span>, <span class="va">addlPkgs</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">wantParallel</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="va">numClus</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="va">funs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">funs</span><span class="op">)</span></span>
<span>        <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>, <span class="va">funs</span><span class="op">)</span></span>
<span>        <span class="co"># env &lt;- environment()</span></span>
<span>        <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>, <span class="st">"addlPkgs"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html">parent.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterEvalQ</a></span><span class="op">(</span><span class="va">cl</span>, <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">addlPkgs</span>, <span class="va">library</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">wrap</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">cl</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">reps</span>, <span class="va">par</span>, <span class="va">burn1</span>, <span class="va">burnFun</span>, <span class="va">objs</span>,</span>
<span>    <span class="va">addlPkgs</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">funNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/deparse.html">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span><span class="op">(</span><span class="va">burn1</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/deparse.html">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span><span class="op">(</span><span class="va">burnFun</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">makeParallel</span><span class="op">(</span><span class="cn">TRUE</span>, numClus <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">cl</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">funNames</span>, <span class="va">objs</span><span class="op">)</span>, <span class="va">addlPkgs</span><span class="op">)</span></span>
<span>    <span class="va">objs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html">mget</a></span><span class="op">(</span><span class="va">objs</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html">parent.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>burn1 <span class="op">=</span> <span class="va">burn1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>, <span class="st">"objs"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html">parent.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">burnMapList</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterApplyLB</a></span><span class="op">(</span><span class="va">cl</span>, <span class="va">reps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"burnFun"</span>, <span class="va">objs</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cl <span class="op">=</span> <span class="va">cl</span>, out <span class="op">=</span> <span class="va">burnMapList</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fitSN</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sna</span>, <span class="va">ros</span>, <span class="va">centreCell</span>, <span class="va">fireSizes</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>    <span class="va">desiredPerimeterArea</span> <span class="op">=</span> <span class="fl">0.004</span>, <span class="va">burnFun</span>, <span class="va">burn1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">sna</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span>    <span class="va">spreadProb</span> <span class="op">&lt;-</span> <span class="va">sna</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span></span>
<span>    <span class="va">sna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="va">sna</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="va">sna</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="va">sna</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="va">sna</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">bfs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">fireSizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fireSize</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">burnFun</span><span class="op">(</span><span class="va">ros</span>, <span class="va">centreCell</span>, <span class="va">fireSize</span>, <span class="va">sna</span>, <span class="va">sizeCutoffs</span>,</span>
<span>            burn1 <span class="op">=</span> <span class="va">burn1</span>, spreadProb <span class="op">=</span> <span class="va">spreadProb</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">bfs1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">bfCount</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">bfs1</span><span class="op">[[</span><span class="va">bfCount</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">LM</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"perim.area.ratio"</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">desiredPerimeterArea</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bfs1</span><span class="op">[[</span><span class="va">bfCount</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">burnedMap</span><span class="op">[</span><span class="op">]</span>,</span>
<span>            na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">fireSizes</span><span class="op">[</span><span class="va">bfCount</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="co"># it needs to get to above 90,000 HA for it to</span></span>
<span>        <span class="co"># count</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span>  <span class="co"># * log10(fireSizes)) # weigh larger ones more</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"bfs1"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">bfs1</span></span>
<span>    <span class="va">a</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fitSN2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>, <span class="va">ros</span>, <span class="va">centreCell</span>, <span class="va">fireSizes</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>    <span class="va">desiredPerimeterArea</span> <span class="op">=</span> <span class="fl">0.003</span>, <span class="va">spreadProb</span> <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">par</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">bfs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">fireSizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fireSize</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">sna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.15</span>, <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fireSize</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">sna</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sna</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">sna</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">sna</span> <span class="op">*</span> <span class="fl">3</span> <span class="op">*</span></span>
<span>            <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">sna</span> <span class="op">*</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="co"># sna &lt;- -1</span></span>
<span>        <span class="fu">burnFun</span><span class="op">(</span><span class="va">ros</span>, <span class="va">centreCell</span>, <span class="va">fireSize</span>, <span class="va">sna</span>, <span class="va">sizeCutoffs</span>,</span>
<span>            <span class="va">burn1</span>, <span class="va">spreadProb</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">bfs1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">bfCount</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">bfs1</span><span class="op">[[</span><span class="va">bfCount</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">LM</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"perim.area.ratio"</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">desiredPerimeterArea</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bfs1</span><span class="op">[[</span><span class="va">bfCount</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">burnedMap</span><span class="op">[</span><span class="op">]</span>,</span>
<span>            na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">fireSizes</span><span class="op">[</span><span class="va">bfCount</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="co"># it needs to get to above 90,000 HA for it to</span></span>
<span>        <span class="co"># count</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"bfs1"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">bfs1</span></span>
<span>    <span class="va">a</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
</div>
<div id="optimizing-parameters" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Optimizing parameters<a class="anchor" aria-label="anchor" href="#optimizing-parameters"><i class="fas fa-link"></i></a>
</h2>
<p>The following code chunk tries to find values of <code>spawnNewActive</code> that creates “reasonable” fire shapes at all sizes.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wantParallel</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">maxRetriesPerID</span> <span class="op">&lt;-</span> <span class="fl">4</span>  <span class="co">## 4 retries (5 attempts total)</span></span>
<span><span class="va">spreadProb</span> <span class="op">&lt;-</span> <span class="fl">0.9</span></span>
<span><span class="va">spawnNewActive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.46</span>, <span class="fl">0.2</span>, <span class="fl">0.26</span>, <span class="fl">0.11</span><span class="op">)</span></span>
<span><span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8000</span>, <span class="fl">20000</span><span class="op">)</span></span>
<span><span class="co"># spawnNewActive &lt;- c(0.1, 0.04, 0.025, 0.01) sizeCutoffs</span></span>
<span><span class="co"># &lt;- c(8e3, 2e4)</span></span>
<span></span>
<span><span class="va">NineCorners</span> <span class="op">&lt;-</span> <span class="fu">cellFromRowCol</span><span class="op">(</span><span class="va">ros</span>, row <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ros</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>    <span class="fl">3</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ros</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">centreCell</span> <span class="op">&lt;-</span> <span class="fu">cellFromRowCol</span><span class="op">(</span><span class="va">ros</span>, row <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ros</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ros</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Set variables</span></span>
<span><span class="va">objs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ros"</span>, <span class="st">"centreCell"</span>, <span class="st">"fireSize"</span>, <span class="st">"spawnNewActive"</span>,</span>
<span>    <span class="st">"sizeCutoffs"</span>, <span class="st">"spreadProb"</span><span class="op">)</span></span>
<span><span class="va">funs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"burnFun"</span>, <span class="st">"burn1"</span><span class="op">)</span></span>
<span><span class="va">addlPkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"data.table"</span>, <span class="st">"raster"</span>, <span class="st">"SDMTools"</span>, <span class="st">"SpaDES.tools"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### SET UP CLUSTER FOR PARALLEL</span></span>
<span><span class="va">numCores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">120L</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.info.html">Sys.info</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"sysname"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Windows"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="va">numCores</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"W-VIC-A1053|pinus[.]for-cast[.]ca"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.info.html">Sys.info</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"nodename"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://Require.predictiveecology.org/reference/Require.html">Require</a></span><span class="op">(</span><span class="st">"future"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">## TODO: customize this to make a cluster on several</span></span>
<span>    <span class="co">## machines via ssh</span></span>
<span>    <span class="va">clNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"localhost"</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"picea.for-cast.ca"</span>,</span>
<span>        <span class="fl">25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"pseudotsuga.for-cast.ca"</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">## check the cluster: 1. at least 10 populations per</span></span>
<span>    <span class="co">## parameter; 7 params; 2. ensure it's a multiple of</span></span>
<span>    <span class="co">## the number of params (7); 3. R can't create more</span></span>
<span>    <span class="co">## than ~125 socket connections.</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clNames</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">70</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clNames</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span><span class="fl">7</span> <span class="op">==</span> <span class="fl">0</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clNames</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">120</span><span class="op">)</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">makeClusterPSOCK</span><span class="op">(</span><span class="va">clNames</span>, homogeneous <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/parallel/RngStream.html">clusterSetRNGStream</a></span><span class="op">(</span><span class="va">cl</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1e+08</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="va">numCores</span>, type <span class="op">=</span> <span class="st">"FORK"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/parallel/RngStream.html">clusterSetRNGStream</a></span><span class="op">(</span><span class="va">cl</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1e+08</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">inherits</a></span><span class="op">(</span><span class="va">cl</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"forknode"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>, <span class="va">funs</span><span class="op">)</span></span>
<span>    <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>, <span class="va">objs</span><span class="op">)</span></span>
<span>    <span class="co"># env &lt;- environment()</span></span>
<span>    <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>, <span class="st">"addlPkgs"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html">parent.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterEvalQ</a></span><span class="op">(</span><span class="va">cl</span>, <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">addlPkgs</span>, <span class="va">library</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opt_sn</span> <span class="op">&lt;-</span> <span class="fu">DEoptim</span><span class="op">(</span><span class="va">fitSN</span>, lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3.5</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">3.5</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span>, control <span class="op">=</span> <span class="fu">DEoptim.control</span><span class="op">(</span>VTR <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>        NP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clNames</span><span class="op">)</span><span class="op">)</span>, itermax <span class="op">=</span> <span class="fl">200</span>, cluster <span class="op">=</span> <span class="va">cl</span>,</span>
<span>        strategy <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, ros <span class="op">=</span> <span class="va">ros</span>, centreCell <span class="op">=</span> <span class="va">centreCell</span>, fireSizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,</span>
<span>        <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span>, <span class="fl">1e+05</span><span class="op">)</span>, desiredPerimeterArea <span class="op">=</span> <span class="fl">0.003</span>,</span>
<span>    burnFun <span class="op">=</span> <span class="va">burnFun</span>, burn1 <span class="op">=</span> <span class="va">burn1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">opt_sn</span><span class="op">$</span><span class="va">optim</span><span class="op">$</span><span class="va">bestmem</span>  <span class="co">## best param values</span></span>
<span><span class="co"># dput(unname(opt_sn$optim$bestmem))</span></span>
<span></span>
<span><span class="co">## assign with suffix to facilitate multiple DEoptim runs</span></span>
<span><span class="va">timestamp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%Y%M%d%H%M%S"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"opt_sn_"</span>, <span class="va">timestamp</span><span class="op">)</span>, <span class="va">opt_sn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">opt_sn</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">moduleDir</span>, <span class="st">"LandMine"</span>, <span class="st">"data"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">timestamp</span>,</span>
<span>    <span class="st">"_DEoptim_250m.rds"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_sn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span>, <span class="fl">1e+05</span><span class="op">)</span></span>
<span><span class="va">fit_sn</span> <span class="op">&lt;-</span> <span class="fu">fitSN</span><span class="op">(</span>sna <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">0.9</span><span class="op">)</span>, ros <span class="op">=</span> <span class="va">ros</span>,</span>
<span>    centreCell <span class="op">=</span> <span class="va">centreCell</span>, fireSizes <span class="op">=</span> <span class="va">fs_sn</span>, desiredPerimeterArea <span class="op">=</span> <span class="fl">0.003</span>,</span>
<span>    burnFun <span class="op">=</span> <span class="va">burnFun</span>, burn1 <span class="op">=</span> <span class="va">burn1</span><span class="op">)</span></span>
<span><span class="va">bfs1_sn</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/transpose.html">transpose</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">fit_sn</span>, <span class="st">"bfs1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LM_sn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">bfs1_sn</span><span class="op">$</span><span class="va">LM</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fs_sn</span>, <span class="va">LM_sn</span><span class="op">[</span>, <span class="st">"perim.area.ratio"</span><span class="op">]</span><span class="op">)</span>  <span class="co">## NOTE: visual inspection - not too round; not too sinuous</span></span></code></pre></div>
<p>A second (alternative) version tries the optimization using fewer parameters, to test whether a simpler version gets better/different results.
Although this version was not used for the final module, we preserve it here for posterity.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_optim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10000</span></span>
<span><span class="va">opt_sn2</span> <span class="op">&lt;-</span> <span class="fu">DEoptim</span><span class="op">(</span><span class="va">fitSN2</span>, lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,</span>
<span>    <span class="op">-</span><span class="fl">0.3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>, control <span class="op">=</span> <span class="fu">DEoptim.control</span><span class="op">(</span>VTR <span class="op">=</span> <span class="fl">0.001</span>, itermax <span class="op">=</span> <span class="fl">40</span>,</span>
<span>    cluster <span class="op">=</span> <span class="va">cl</span>, strategy <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, ros <span class="op">=</span> <span class="va">ros</span>, centreCell <span class="op">=</span> <span class="va">centreCell</span>,</span>
<span>    fireSizes <span class="op">=</span> <span class="va">fs_optim2</span>, desiredPerimeterArea <span class="op">=</span> <span class="fl">0.003</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_sn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">4000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit_sn2</span> <span class="op">&lt;-</span> <span class="fu">fitSN2</span><span class="op">(</span>par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">0.63333</span>, <span class="fl">1</span>, <span class="fl">3.2</span>, <span class="fl">4.4</span><span class="op">)</span>, ros <span class="op">=</span> <span class="va">ros</span>,</span>
<span>    centreCell <span class="op">=</span> <span class="va">centreCell</span>, fireSizes <span class="op">=</span> <span class="va">fs_sn2</span>, desiredPerimeterArea <span class="op">=</span> <span class="fl">0.003</span>,</span>
<span>    spreadProb <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">bfs1_sn2</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/transpose.html">transpose</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">fit_sn2</span>, <span class="st">"bfs1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LM_sn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">bfs1_sn2</span><span class="op">$</span><span class="va">LM</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fs_sn2</span>, <span class="va">LM_sn2</span><span class="op">[</span>, <span class="st">"perim.area.ratio"</span><span class="op">]</span><span class="op">)</span>  <span class="co">## NOTE: visual inspection - not too round; not too sinuous</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
</div>
<div id="manual-inspection-of-optimization-results" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Manual inspection of optimization results<a class="anchor" aria-label="anchor" href="#manual-inspection-of-optimization-results"><i class="fas fa-link"></i></a>
</h2>
<div id="original-2018-version" class="section level3" number="8.5.1">
<h3>
<span class="header-section-number">8.5.1</span> Original (2018) version<a class="anchor" aria-label="anchor" href="#original-2018-version"><i class="fas fa-link"></i></a>
</h3>
<p>The original version was run using 100m pixels, despite the simulations being run using 250m pixels.
This was corrected and rerun below.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 10,000 hectares burns gave this</span></span>
<span><span class="va">spawnNewActive</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0235999945606232</span>, <span class="fl">0.0263073265505955</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 100,000 hectare burns gave this spawnNewActive &lt;-</span></span>
<span><span class="co"># 10^c(-1.264780, -1.970946, -1.288213, -2.202580)</span></span>
<span><span class="va">spawnNewActive</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.586503645288758</span>, <span class="op">-</span><span class="fl">1.08108837273903</span>,</span>
<span>    <span class="op">-</span><span class="fl">2.14391896536108</span>, <span class="op">-</span><span class="fl">1.00221184641123</span><span class="op">)</span></span>
<span><span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.37711253212765</span>, <span class="fl">4.52040993282571</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.733262</span>, <span class="op">-</span><span class="fl">0.933318</span>, <span class="op">-</span><span class="fl">2.562183</span>, <span class="op">-</span><span class="fl">2.493687</span>, <span class="fl">3.064458</span>,</span>
<span>    <span class="fl">4.812305</span><span class="op">)</span></span>
<span><span class="va">spawnNewActive</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">sns</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">sns</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co"># spawnNewActive &lt;- 10^c(-1.646419, -1.815395, -2.809013,</span></span>
<span><span class="co"># -2.613337) sizeCutoffs &lt;- 10^c(3.888317, 4.641961)</span></span>
<span></span>
<span><span class="co">## 100,000 pixel fires -- the next worked, but I think we</span></span>
<span><span class="co">## can get better sns &lt;- structure(</span></span>
<span><span class="co">## c(-1.652459,-0.962121,-0.964879,-2.304902, 3.522345,</span></span>
<span><span class="co">## 4.173242), .Names = c('par1',</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.641197</span>, <span class="op">-</span><span class="fl">1.152821</span>, <span class="op">-</span><span class="fl">0.697335</span>, <span class="op">-</span><span class="fl">1.751917</span>,</span>
<span>    <span class="fl">3.720378</span>, <span class="fl">4.034059</span><span class="op">)</span>, .Names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"par1"</span>, <span class="st">"par2"</span>, <span class="st">"par3"</span>, <span class="st">"par4"</span>,</span>
<span>    <span class="st">"par5"</span>, <span class="st">"par6"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">spawnNewActive</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">sns</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="va">sns</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fireSize</span> <span class="op">&lt;-</span> <span class="fl">30000</span></span>
<span></span>
<span><span class="co">## 100</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.77716149196811</span>, <span class="op">-</span><span class="fl">0.769325340166688</span>, <span class="op">-</span><span class="fl">1.2772046867758</span>,</span>
<span>    <span class="op">-</span><span class="fl">1.99332102853805</span>, <span class="fl">3.14260408212431</span>, <span class="fl">4.46155184064992</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 1000</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.775107</span>, <span class="op">-</span><span class="fl">1.03176</span>, <span class="op">-</span><span class="fl">0.599669</span>, <span class="op">-</span><span class="fl">1.958105</span>, <span class="fl">3.048958</span>,</span>
<span>    <span class="fl">4.275831</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## seemed good for 100,000, pretty good for 1e3</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.54885</span>, <span class="op">-</span><span class="fl">0.97052</span>, <span class="op">-</span><span class="fl">1.38305</span>, <span class="op">-</span><span class="fl">1.93759</span>, <span class="fl">3.20379</span>, <span class="fl">4.13237</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## good for 100 000, 10 000 ha -- too sinuous for 1000 and</span></span>
<span><span class="co">## 100 ha</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.537203</span>, <span class="op">-</span><span class="fl">1.462981</span>, <span class="op">-</span><span class="fl">0.524957</span>, <span class="op">-</span><span class="fl">1.002567</span>, <span class="fl">3.642046</span>,</span>
<span>    <span class="fl">4.501754</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## good for 100 000, 10 000 ha (except some fires @ 1e5</span></span>
<span><span class="co">## don't make it to full size) -- too sinuous for smaller</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.484338</span>, <span class="op">-</span><span class="fl">1.22044</span>, <span class="op">-</span><span class="fl">2.948275</span>, <span class="op">-</span><span class="fl">2.15594</span>, <span class="fl">3.945281</span>,</span>
<span>    <span class="fl">4.904893</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.495247</span>, <span class="op">-</span><span class="fl">0.800494</span>, <span class="op">-</span><span class="fl">1.58235</span>, <span class="op">-</span><span class="fl">2.270646</span>, <span class="fl">3.530671</span>,</span>
<span>    <span class="fl">4.663245</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## final optimization after 75 iterations, Good: 1e5, 1e4</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.47809</span>, <span class="op">-</span><span class="fl">0.86224</span>, <span class="op">-</span><span class="fl">1.34532</span>, <span class="op">-</span><span class="fl">1.93568</span>, <span class="fl">3.27149</span>, <span class="fl">4.20741</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## based on equal weights 10^(1:5)</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.923528</span>, <span class="op">-</span><span class="fl">1.804549</span>, <span class="op">-</span><span class="fl">1.760455</span>, <span class="op">-</span><span class="fl">1.793594</span>, <span class="fl">1.683355</span>,</span>
<span>    <span class="fl">4.466668</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## With spreadProb = 0.9 # Pretty GOOD!</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.73152</span>, <span class="op">-</span><span class="fl">0.501823</span>, <span class="op">-</span><span class="fl">0.605968</span>, <span class="op">-</span><span class="fl">1.809726</span>, <span class="fl">2.202732</span>,</span>
<span>    <span class="fl">4.69606</span>, <span class="fl">0.9</span><span class="op">)</span>  <span class="co">## used in module</span></span>
<span></span>
<span><span class="co">## With spreadProb = 0.9 # Optimal</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.978947</span>, <span class="op">-</span><span class="fl">0.540946</span>, <span class="op">-</span><span class="fl">0.790736</span>, <span class="op">-</span><span class="fl">1.583039</span>, <span class="fl">2.532013</span>,</span>
<span>    <span class="fl">4.267547</span>, <span class="fl">0.94673</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spawnNewActive</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">sns</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="va">sns</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">sns</span><span class="op">)</span> <span class="op">==</span> <span class="fl">7</span><span class="op">)</span> <span class="va">spreadProb</span> <span class="op">&lt;-</span> <span class="va">sns</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># from linear model version</span></span>
<span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.548899</span>, <span class="op">-</span><span class="fl">0.396904</span>, <span class="fl">2.191424</span>, <span class="fl">3.903082</span>, <span class="fl">4.854002</span><span class="op">)</span></span>
<span><span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">par</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.15</span>, <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fireSize</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sna</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sna</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">sna</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">sna</span> <span class="op">*</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>    <span class="va">sna</span> <span class="op">*</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">spawnNewActive</span> <span class="op">&lt;-</span> <span class="va">sna</span></span>
<span></span>
<span><span class="co">###########################</span></span>
<span><span class="fu">clearPlot</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">dev</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fireSize</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">i</span></span>
<span>    <span class="va">dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">fireSize</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">250</span><span class="op">)</span></span>
<span>    <span class="va">ros</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="fu">extent</span><span class="op">(</span><span class="fl">0</span>, <span class="va">dim</span>, <span class="fl">0</span>, <span class="va">dim</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">250</span>, vals <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">centreCell</span> <span class="op">&lt;-</span> <span class="fu">cellFromRowCol</span><span class="op">(</span><span class="va">ros</span>, rownr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ros</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, colnr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ros</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"rep"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fireSize</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="va">burnedMapList</span> <span class="op">&lt;-</span> <span class="fu">wrap</span><span class="op">(</span>cl <span class="op">=</span> <span class="va">cl</span>, reps <span class="op">=</span> <span class="va">reps</span>, par <span class="op">=</span> <span class="cn">TRUE</span>, burn1 <span class="op">=</span> <span class="va">burn1</span>,</span>
<span>        burnFun <span class="op">=</span> <span class="va">burnFun</span>, objs <span class="op">=</span> <span class="va">objs</span>, libs <span class="op">=</span> <span class="va">addlPkgs</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">burnedMapList</span><span class="op">$</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">reps</span></span>
<span>    <span class="va">burnedMapList</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/transpose.html">transpose</a></span><span class="op">(</span><span class="va">burnedMapList</span><span class="op">$</span><span class="va">out</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">burnedMapList</span><span class="op">$</span><span class="va">LM</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu">Plot</span><span class="op">(</span><span class="va">burnedMapList</span><span class="op">$</span><span class="va">burnedMap</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>, new <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        na.color <span class="op">=</span> <span class="st">"white"</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, visualSqueeze <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Fire size: "</span>, <span class="va">fireSize</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"rep"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">perims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">perm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">dev</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">clearPlot</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fireSizes</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">fs</span> <span class="kw">in</span> <span class="va">fireSizes</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">ros</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="fu">extent</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2e+05</span>, <span class="fl">0</span>, <span class="fl">2e+05</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">250</span>,</span>
<span>            vals <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="va">NineCorners</span> <span class="op">&lt;-</span> <span class="fu">cellFromRowCol</span><span class="op">(</span><span class="va">ros</span>, rownr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ros</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span> <span class="op">*</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, colnr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ros</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">centreCell</span> <span class="op">&lt;-</span> <span class="va">NineCorners</span></span>
<span>        <span class="va">ran</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">4</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="va">spawnNewActive</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">ran</span></span>
<span>        <span class="co"># spawnNewActive &lt;- 10^c(-0.1, -0.75, -1.2,</span></span>
<span>        <span class="co"># ran*2.5)</span></span>
<span>        <span class="va">fireSize</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">fs</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">centreCell</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>        <span class="va">burnedMapList</span> <span class="op">&lt;-</span> <span class="fu">wrap</span><span class="op">(</span>cl <span class="op">=</span> <span class="va">cl</span>, reps <span class="op">=</span> <span class="va">reps</span>, par <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            burn1 <span class="op">=</span> <span class="va">burn1</span>, burnFun <span class="op">=</span> <span class="va">burnFun</span>, objs <span class="op">=</span> <span class="va">objs</span>, libs <span class="op">=</span> <span class="va">addlPkgs</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">burnedMapList</span><span class="op">$</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">reps</span></span>
<span>        <span class="va">burnedMapList</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/transpose.html">transpose</a></span><span class="op">(</span><span class="va">burnedMapList</span><span class="op">$</span><span class="va">out</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">burnedMapList</span><span class="op">$</span><span class="va">LM</span><span class="op">)</span></span>
<span>        <span class="fu">Plot</span><span class="op">(</span><span class="va">burnedMapList</span><span class="op">$</span><span class="va">burnedMap</span>, new <span class="op">=</span> <span class="cn">TRUE</span>, zero.color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span>        <span class="va">perims</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>perim <span class="op">=</span> <span class="va">burnedMapList</span><span class="op">$</span><span class="va">LM</span><span class="op">$</span><span class="va">rep1</span><span class="op">$</span><span class="va">perim.area.ratio</span>,</span>
<span>            spawnNewActive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">spawnNewActive</span><span class="op">)</span>, others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">spawnNewActive</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">fsChar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></span>
<span>    <span class="va">perm</span><span class="op">[[</span><span class="va">fsChar</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">rbindlist</span><span class="op">(</span><span class="va">perims</span><span class="op">)</span></span>
<span>    <span class="va">perm</span><span class="op">[[</span><span class="va">fsChar</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">perim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">perm</span><span class="op">[[</span><span class="va">fsChar</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">perim</span><span class="op">)</span></span>
<span>    <span class="va">perm</span><span class="op">[[</span><span class="va">fsChar</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">spawnNewActive</span> <span class="op">&lt;-</span> <span class="va">perm</span><span class="op">[[</span><span class="va">fsChar</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">spawnNewActive</span></span>
<span>    <span class="fu">Plot</span><span class="op">(</span><span class="va">perm</span><span class="op">[[</span><span class="va">fsChar</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">perim</span>, <span class="va">perm</span><span class="op">[[</span><span class="va">fsChar</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">spawnNewActive</span>,</span>
<span>        new <span class="op">=</span> <span class="cn">TRUE</span>, addTo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"fs"</span>, <span class="va">fsChar</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">mod</span><span class="op">[[</span><span class="va">fsChar</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">spawnNewActive</span> <span class="op">~</span> <span class="va">perim</span>, data <span class="op">=</span> <span class="va">perm</span><span class="op">[[</span><span class="va">fsChar</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span><span class="op">[[</span><span class="st">"10"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>perim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fl">0.003</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span><span class="op">[[</span><span class="st">"100"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>perim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fl">0.003</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span><span class="op">[[</span><span class="st">"1000"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>perim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fl">0.003</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="current-2022-version" class="section level3" number="8.5.2">
<h3>
<span class="header-section-number">8.5.2</span> Current (2022) version<a class="anchor" aria-label="anchor" href="#current-2022-version"><i class="fas fa-link"></i></a>
</h3>
<p>The original version was run using 100m pixels, despite the simulations being run using 250m pixels.
This version uses 250m pixels.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## final optimization after 170 iterations (fitSN)</span></span>
<span><span class="va">sns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="va">opt_sn</span><span class="op">$</span><span class="va">optim</span><span class="op">$</span><span class="va">bestmem</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spawnNewActive</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">sns</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="va">sns</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">spreadProb</span> <span class="op">&lt;-</span> <span class="va">sns</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## from linear model version</span></span>
<span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.548899</span>, <span class="op">-</span><span class="fl">0.396904</span>, <span class="fl">2.191424</span>, <span class="fl">3.903082</span>, <span class="fl">4.854002</span><span class="op">)</span></span>
<span><span class="va">sizeCutoffs</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">par</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.15</span>, <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fireSize</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sna</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sna</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">sna</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">sna</span> <span class="op">*</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>    <span class="va">sna</span> <span class="op">*</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">spawnNewActive</span> <span class="op">&lt;-</span> <span class="va">sna</span></span>
<span></span>
<span><span class="fu">clearPlot</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fireSize</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">i</span></span>
<span>    <span class="va">dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">fireSize</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">250</span><span class="op">)</span></span>
<span>    <span class="va">ros</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="fu">extent</span><span class="op">(</span><span class="fl">0</span>, <span class="va">dim</span>, <span class="fl">0</span>, <span class="va">dim</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">250</span>, vals <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">centreCell</span> <span class="op">&lt;-</span> <span class="fu">cellFromRowCol</span><span class="op">(</span><span class="va">ros</span>, row <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ros</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ros</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"rep"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fireSize</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="va">burnedMapList</span> <span class="op">&lt;-</span> <span class="fu">wrap</span><span class="op">(</span>cl <span class="op">=</span> <span class="va">cl</span>, reps <span class="op">=</span> <span class="va">reps</span>, par <span class="op">=</span> <span class="cn">TRUE</span>, burn1 <span class="op">=</span> <span class="va">burn1</span>,</span>
<span>        burnFun <span class="op">=</span> <span class="va">burnFun</span>, objs <span class="op">=</span> <span class="va">objs</span>, addlPkgs <span class="op">=</span> <span class="va">addlPkgs</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">burnedMapList</span><span class="op">$</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">reps</span></span>
<span>    <span class="va">burnedMapList</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/transpose.html">transpose</a></span><span class="op">(</span><span class="va">burnedMapList</span><span class="op">$</span><span class="va">out</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">burnedMapList</span><span class="op">$</span><span class="va">LM</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu">Plot</span><span class="op">(</span><span class="va">burnedMapList</span><span class="op">$</span><span class="va">burnedMap</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>, new <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        na.color <span class="op">=</span> <span class="st">"white"</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, visualSqueeze <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Fire size: "</span>, <span class="va">fireSize</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="cleaning-up" class="section level3" number="8.5.3">
<h3>
<span class="header-section-number">8.5.3</span> Cleaning up<a class="anchor" aria-label="anchor" href="#cleaning-up"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html">unlink</a></span><span class="op">(</span><span class="va">cacheDir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="code-and-data-availability" class="section level3" number="8.5.4">
<h3>
<span class="header-section-number">8.5.4</span> Code and data availability<a class="anchor" aria-label="anchor" href="#code-and-data-availability"><i class="fas fa-link"></i></a>
</h3>
<p>Code available from <a href="https://github.com/PredictiveEcology/LandMine" class="uri">https://github.com/PredictiveEcology/LandMine</a>.</p>
</div>
<div id="links-to-other-modules-3" class="section level3" number="8.5.5">
<h3>
<span class="header-section-number">8.5.5</span> Links to other modules<a class="anchor" aria-label="anchor" href="#links-to-other-modules-3"><i class="fas fa-link"></i></a>
</h3>
<p>Originally developed as part of the <a href="https://github.com/PredictiveEcology/LandWeb">LandWeb</a> project.
## References
</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="wildfire-submodel.html">Wildfire submodel</a></div>
<div class="next"><a href="model-outputs.html">Model outputs</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#landmine-module"><span class="header-section-number">8</span> LandMine Module</a></li>
<li>
<a class="nav-link" href="#module-overview-5"><span class="header-section-number">8.1</span> Module Overview</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#module-summary-3"><span class="header-section-number">8.1.1</span> Module summary</a></li>
<li><a class="nav-link" href="#model-differences"><span class="header-section-number">8.1.2</span> Model Differences</a></li>
<li><a class="nav-link" href="#known-species"><span class="header-section-number">8.1.3</span> Known Species</a></li>
<li><a class="nav-link" href="#module-inputs-and-parameters-1"><span class="header-section-number">8.1.4</span> Module inputs and parameters</a></li>
<li><a class="nav-link" href="#module-outputs-2"><span class="header-section-number">8.1.5</span> Module outputs</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#usage"><span class="header-section-number">8.2</span> Usage</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#package-dependencies"><span class="header-section-number">8.2.1</span> Package dependencies</a></li>
<li><a class="nav-link" href="#module-usage"><span class="header-section-number">8.2.2</span> Module usage</a></li>
</ul>
</li>
<li><a class="nav-link" href="#testing-the-burn-algorithm"><span class="header-section-number">8.3</span> Testing the burn algorithm</a></li>
<li><a class="nav-link" href="#optimizing-parameters"><span class="header-section-number">8.4</span> Optimizing parameters</a></li>
<li>
<a class="nav-link" href="#manual-inspection-of-optimization-results"><span class="header-section-number">8.5</span> Manual inspection of optimization results</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#original-2018-version"><span class="header-section-number">8.5.1</span> Original (2018) version</a></li>
<li><a class="nav-link" href="#current-2022-version"><span class="header-section-number">8.5.2</span> Current (2022) version</a></li>
<li><a class="nav-link" href="#cleaning-up"><span class="header-section-number">8.5.3</span> Cleaning up</a></li>
<li><a class="nav-link" href="#code-and-data-availability"><span class="header-section-number">8.5.4</span> Code and data availability</a></li>
<li><a class="nav-link" href="#links-to-other-modules-3"><span class="header-section-number">8.5.5</span> Links to other modules</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PredictiveEcology/LandWeb/blob/master/../m/LandMine/LandMine2.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PredictiveEcology/LandWeb/edit/master/../m/LandMine/LandMine2.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>LandWeb Manual</strong>: v. 3.0.0" was written by Alex M. Chubaty; Ceres Barros; Ian M. S. Eddy; Eliot J. B. McIntire; David W. Andison. It was last built on 2023-08-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
