---
title: "LandWeb FMA Boundaries"
author: "Alex M. Chubaty"
date: "December 19, 2018"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(autodep = TRUE, echo = TRUE)

library(ggplot2)
library(sf)
library(sp)
library(raster)

dataDir <- fiel.path("inputs", "FMA_Boundaries")
```
# FMA Boundaries

## FMA Boundaries Data

### `FMA_Boundary_CustomProj`

This is identical to `FMA_Boundary_Updated`, which is currently used in the app.

```{r fma1}
fshp1 <- file.path(dataDir, "FMA_Boundary_Updated/FMA_Boundary_Updated.shp")
shp1 <- shapefile(fshp1)
proj4string(shp1)
plot(shp1, col = "lightgrey")
```

### `FMA_Boundary_Updated`

This is the one used in the app, and available at <https://drive.google.com/file/d/1nTFOcrdMf1hIsxd_yNCSTr8RrYNHHwuc/view?usp=sharing>.
It is downloaded and processed in `LandWeb_shiny` module.

```{r fma2}
fshp2 <- file.path(dataDir, "FMA_Boundary_CustomProj/FMA_Boundary_Updated.shp")
shp2 <- shapefile(fshp2)
proj4string(shp2)
plot(shp2, col = "lightgrey")

identical(shp1, shp2)
```

### `FMA_Boundary_Updated_12N`

This is basically identical to the others but isn't using the custom projection (very small differences when comparing the reprojected version to the others).

```{r fma3}
fshp3 <- file.path(dataDir, "FMA_Boundary_Updated_12N/FMA_Boundary_Updated_12N.shp")
shp3 <- shapefile(fshp3)
proj4string(shp3)
plot(shp3, col = "lightgrey")

shp3_reproj <- spTransform(shp3, CRS(proj4string(shp2)))

identical(shp2, shp3_reproj) ## FALSE
all.equal(shp2, shp3_reproj)
```

## FMA Map

```{r fma-map, echo = FALSE}
sf2 <- st_read(fshp2)
centroids_sf2 <- cbind(st_centroid(sf2), st_coordinates(st_centroid(sf2$geometry)))

ggplot(data = sf2) +
  geom_sf(mapping = aes(fill = as.factor(OBJECTID_1 %% 10))) +
  scale_fill_brewer(type = "div", palette = "Spectral") +
  geom_text(data = centroids_sf2, mapping = aes(x = X, y = Y, label = OBJECTID_1)) + 
  labs(title = "FMA boundaries within the LandWeb study area") + 
  xlab("Longitude") +
  ylab("Latitude") + 
  guides(fill = FALSE) +
  theme_bw()
```


```{r fma-table, echo = FALSE}
knitr::kable(data.frame(ID = sf2$OBJECTID_1, Name = sf2$Name))
```


# FMU Boundaries (AB)

## FMU Boundaries Data + Map

```{r fmu}
fshp_fmu <- file.path("inputs", "FMU/FMU.shp")
sf_fmu <- st_read(fshp_fmu)
centroids_fmu <- cbind(st_centroid(sf_fmu), st_coordinates(st_centroid(sf_fmu$geometry)))

ggplot(data = sf_fmu) +
  geom_sf(mapping = aes(fill = as.factor(OBJECTID %% 10))) +
  scale_fill_brewer(type = "div", palette = "Spectral") +
  geom_text(data = centroids_fmu, mapping = aes(x = X, y = Y, label = OBJECTID)) + 
  labs(title = "Alberta FMU boundaries") + 
  xlab("Longitude") +
  ylab("Latitude") + 
  guides(fill = FALSE) +
  theme_bw()
```

